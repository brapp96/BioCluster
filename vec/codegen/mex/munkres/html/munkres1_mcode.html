<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">assignment</span>,<span class="var type1" id="S3T2U4">cost</span>] = munkres(<span class="var type1" id="S4T3U7">costMat</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">% MUNKRES   Munkres (Hungarian) Algorithm for Linear Assignment Problem. </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">% [ASSIGN,COST] = munkres(COSTMAT) returns the optimal column indices,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% ASSIGN assigned to each row and the minimum COST based on the assignment</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">% problem represented by the COSTMAT, where the (i,j)th element represents the cost to assign the jth</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">% job to the ith worker.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">% Partial assignment: This code can identify a partial assignment is a full</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">% assignment is not feasible. For a partial assignment, there are some</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">% zero elements in the returning assignment vector, which indicate</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">% un-assigned tasks. The cost returned only contains the cost of partially</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">% assigned tasks.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">% This is vectorized implementation of the algorithm. It is the fastest</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">% among all Matlab implementations of the algorithm.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">% Examples</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">% Example 1: a 5 x 5 example</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment"><span class="comment">%{</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">[assignment,cost] = munkres(magic(5));</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">disp(assignment); <span class="comment">% 3 2 1 5 4</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">disp(cost); <span class="comment">%15</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"><span class="comment"><span class="comment">%}</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">% Example 2: 400 x 400 random data</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="comment"><span class="comment">%{</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">n=400;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">A=rand(n);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">tic</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">[a,b]=munkres(A);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">toc                 <span class="comment">% about 2 seconds </span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="comment"><span class="comment">%}</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="comment">% Example 3: rectangular assignment with inf costs</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="comment"><span class="comment">%{</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">A=rand(10,7);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="comment">A(A&gt;0.7)=Inf;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">[a,b]=munkres(A);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="comment"><span class="comment">%}</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="comment">% Example 4: an example of partial assignment</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="comment"><span class="comment">%{</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="comment">A = [1 3 Inf; Inf Inf 5; Inf Inf 0.5]; </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="comment">[a,b]=munkres(A)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="comment"><span class="comment">%}</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="comment">% a = [1 0 3]</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"><span class="comment">% b = 1.5</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">% Reference:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="comment">% "Munkres' Assignment Algorithm, Modified for Rectangular Matrices", </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="comment">% http://csclab.murraystate.edu/bob.pilgrim/445/munkres.html</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"><span class="comment">% version 2.3 by Yi Cao at Cranfield University on 11th September 2011</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line"><span class="mxinfo " id="T1:U4"><span class="var type1" id="S2T1U10">assignment</span> = <span class="mxinfo " id="T1:U6">zeros(<span class="mxinfo " id="T2:U7">1</span>,<span class="mxinfo " id="T2:U8">size(<span class="var type1" id="S4T3U16">costMat</span>,1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line"><span class="mxinfo " id="T2:U10"><span class="var type1" id="S3T2U20">cost</span> = <span class="mxinfo " id="T2:U12">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line"><span class="mxinfo " id="T4:U13"><span class="var type1" id="S7T4U24">validMat</span> = <span class="mxinfo " id="T4:U15"><span class="mxinfo " id="T4:U16"><span class="var type1" id="S4T3U27">costMat</span> == <span class="var type1" id="S4T3U28">costMat</span></span> &amp; <span class="mxinfo " id="T4:U19"><span class="var type1" id="S4T3U30">costMat</span> &lt; <span class="mxinfo " id="T2:U21">Inf</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line"><span class="mxinfo " id="T2:U22"><span class="var type1" id="S9T2U35">bigM</span> = <span class="mxinfo " id="T2:U24"><span class="mxinfo " id="T2:U25">10</span>^(<span class="mxinfo " id="T2:U26"><span class="mxinfo " id="T2:U27">ceil(<span class="mxinfo " id="T2:U28">log10(<span class="mxinfo " id="T2:U29">sum(<span class="mxinfo " id="T5:U30"><span class="var type1" id="S4T3U47">costMat</span>(<span class="var type1" id="S7T4U48">validMat</span>)</span>)</span>)</span>)</span>+<span class="mxinfo " id="T2:U33">1</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line"><span class="mxinfo " id="T5:U34"><span class="mxinfo " id="T5:U35"><span class="var type1" id="S4T3U53">costMat</span>(<span class="mxinfo " id="T4:U37">~<span class="var type1" id="S7T4U55">validMat</span></span>)</span> = <span class="var type1" id="S9T2U56">bigM</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line"><span class="comment">% costMat(costMat~=costMat)=Inf;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line"><span class="comment">% validMat = costMat&lt;Inf;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line"><span class="mxinfo " id="T6:U40"><span class="var type1" id="S13T6U59">validCol</span> = <span class="mxinfo " id="T6:U42">any(<span class="var type1" id="S7T4U62">validMat</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line"><span class="mxinfo " id="T7:U44"><span class="var type1" id="S15T7U66">validRow</span> = <span class="mxinfo " id="T7:U46">any(<span class="var type1" id="S7T4U69">validMat</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line"><span class="mxinfo " id="T2:U48"><span class="var type1" id="S16T2U73">nRows</span> = <span class="mxinfo " id="T2:U50">sum(<span class="var type1" id="S15T7U76">validRow</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line"><span class="mxinfo " id="T2:U52"><span class="var type1" id="S17T2U79">nCols</span> = <span class="mxinfo " id="T2:U54">sum(<span class="var type1" id="S13T6U82">validCol</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line"><span class="mxinfo " id="T2:U56"><span class="var type1" id="S18T2U85">n</span> = <span class="mxinfo " id="T2:U58">max(<span class="var type1" id="S16T2U88">nRows</span>,<span class="var type1" id="S17T2U89">nCols</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T8:U61">~<span class="var type1" id="S18T2U93">n</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">    <span class="keyword">return</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line"><span class="mxinfo " id="T2:U63"><span class="var type1" id="S20T2U97">maxv</span>=<span class="mxinfo " id="T2:U65"><span class="mxinfo " id="T2:U66">10</span>*<span class="mxinfo " id="T2:U67">max(<span class="mxinfo " id="T5:U68"><span class="var type1" id="S4T3U103">costMat</span>(<span class="var type1" id="S7T4U104">validMat</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line"><span class="mxinfo " id="T3:U71"><span class="var type1" id="S21T3U107">dMat</span> = <span class="mxinfo " id="T3:U73"><span class="mxinfo " id="T3:U74">zeros(<span class="var type1" id="S18T2U111">n</span>)</span> + <span class="var type1" id="S20T2U112">maxv</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line"><span class="mxinfo " id="T3:U77"><span class="mxinfo " id="T3:U78"><span class="var type1" id="S21T3U116">dMat</span>(<span class="mxinfo " id="T1:U80"><span class="mxinfo " id="T2:U81">1</span>:<span class="var type1" id="S16T2U119">nRows</span></span>,<span class="mxinfo " id="T1:U83"><span class="mxinfo " id="T2:U84">1</span>:<span class="var type1" id="S17T2U122">nCols</span></span>)</span> = <span class="mxinfo " id="T3:U86"><span class="var type1" id="S4T3U124">costMat</span>(<span class="var type1" id="S15T7U125">validRow</span>,<span class="var type1" id="S13T6U126">validCol</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line"><span class="comment">%*************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line"><span class="comment">% Munkres' Assignment Algorithm starts here</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line"><span class="comment">%*************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line"><span class="comment">%   STEP 1: Subtract the row minimum from each row.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line"><span class="mxinfo " id="T5:U90"><span class="var type1" id="S22T5U129">minR</span> = <span class="mxinfo " id="T5:U92">min(<span class="var type1" id="S21T3U132">dMat</span>,[],2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line"><span class="mxinfo " id="T1:U94"><span class="var type1" id="S24T1U138">minC</span> = <span class="mxinfo " id="T1:U96">min(<span class="mxinfo " id="T3:U97">bsxfun(@minus, <span class="var type1" id="S21T3U145">dMat</span>, <span class="var type1" id="S22T5U146">minR</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line"><span class="comment">%**************************************************************************  </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line"><span class="comment">%   STEP 2: Find a zero of dMat. If there are no starred zeros in its</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line"><span class="comment">%           column or row start the zero. Repeat for each zero</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line"><span class="comment">%**************************************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line"><span class="mxinfo " id="T4:U100"><span class="var type1" id="S27T4U149">zP</span> = <span class="mxinfo " id="T4:U102"><span class="var type1" id="S21T3U151">dMat</span> == <span class="mxinfo " id="T3:U104">bsxfun(@plus, <span class="var type1" id="S24T1U156">minC</span>, <span class="var type1" id="S22T5U157">minR</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line"><span class="mxinfo " id="T5:U107"><span class="var type1" id="S29T5U160">starZ</span> = <span class="mxinfo " id="T5:U109">zeros(<span class="var type1" id="S18T2U163">n</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line"><span class="keyword">while</span> <span class="mxinfo " id="T8:U111">any(<span class="mxinfo " id="T7:U112"><span class="var type1" id="S27T4U169">zP</span>(:)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">    [<span class="var type1" id="S30T5U174">r</span>,<span class="var type1" id="S31T5U175">c</span>]=find(<span class="var type1" id="S27T4U178">zP</span>,1);</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">    <span class="mxinfo " id="T5:U117"><span class="mxinfo " id="T5:U118"><span class="var type1" id="S29T5U183">starZ</span>(<span class="var type1" id="S30T5U184">r</span>)</span>=<span class="var type1" id="S31T5U185">c</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">    <span class="mxinfo " id="T4:U122"><span class="mxinfo " id="T4:U123"><span class="var type1" id="S27T4U189">zP</span>(<span class="var type1" id="S30T5U190">r</span>,<span class="mxinfo " id="T9:U126">:</span>)</span>=<span class="mxinfo " id="T8:U127">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">    <span class="mxinfo " id="T4:U128"><span class="mxinfo " id="T4:U129"><span class="var type1" id="S27T4U197">zP</span>(<span class="mxinfo " id="T9:U131">:</span>,<span class="var type1" id="S31T5U199">c</span>)</span>=<span class="mxinfo " id="T8:U133">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line"><span class="keyword">while</span> <span class="mxinfo " id="T2:U134">1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line"><span class="comment">%**************************************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line"><span class="comment">%   STEP 3: Cover each column with a starred zero. If all the columns are</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line"><span class="comment">%           covered then the matching is maximum</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line"><span class="comment">%**************************************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T8:U135">all(<span class="mxinfo " id="T7:U136"><span class="var type1" id="S29T5U209">starZ</span>&gt;<span class="mxinfo " id="T2:U138">0</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">        <span class="keyword">break</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">    <span class="mxinfo " id="T6:U139"><span class="var type1" id="S35T6U214">coverColumn</span> = <span class="mxinfo " id="T6:U141"><span class="mxinfo " id="T8:U142">false</span>(<span class="mxinfo " id="T2:U143">1</span>,<span class="var type1" id="S18T2U218">n</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">    <span class="mxinfo " id="T7:U145"><span class="mxinfo " id="T7:U146"><span class="var type1" id="S35T6U222">coverColumn</span>(<span class="mxinfo " id="T5:U148"><span class="var type1" id="S29T5U224">starZ</span>(<span class="mxinfo " id="T7:U150"><span class="var type1" id="S29T5U226">starZ</span>&gt;<span class="mxinfo " id="T2:U152">0</span></span>)</span>)</span>=<span class="mxinfo " id="T8:U153">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">    <span class="mxinfo " id="T7:U154"><span class="var type1" id="S37T7U232">coverRow</span> = <span class="mxinfo " id="T7:U156"><span class="mxinfo " id="T8:U157">false</span>(<span class="var type1" id="S18T2U235">n</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">    <span class="mxinfo " id="T5:U159"><span class="var type1" id="S38T5U239">primeZ</span> = <span class="mxinfo " id="T5:U161">zeros(<span class="var type1" id="S18T2U242">n</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">    [<span class="var type1" id="S39T5U247">rIdx</span>, <span class="var type1" id="S40T5U248">cIdx</span>] = find(<span class="mxinfo " id="T4:U165"><span class="mxinfo " id="T3:U166"><span class="var type1" id="S21T3U253">dMat</span>(<span class="mxinfo " id="T7:U168">~<span class="var type1" id="S37T7U255">coverRow</span></span>,<span class="mxinfo " id="T6:U170">~<span class="var type1" id="S35T6U257">coverColumn</span></span>)</span>==<span class="mxinfo " id="T3:U172">bsxfun(@plus,<span class="mxinfo " id="T5:U173"><span class="var type1" id="S22T5U263">minR</span>(<span class="mxinfo " id="T7:U175">~<span class="var type1" id="S37T7U265">coverRow</span></span>)</span>,<span class="mxinfo " id="T1:U177"><span class="var type1" id="S24T1U267">minC</span>(<span class="mxinfo " id="T6:U179">~<span class="var type1" id="S35T6U269">coverColumn</span></span>)</span>)</span></span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">    <span class="keyword">while</span> <span class="mxinfo " id="T2:U181">1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">        <span class="comment">%**************************************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">        <span class="comment">%   STEP 4: Find a noncovered zero and prime it.  If there is no starred</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">        <span class="comment">%           zero in the row containing this primed zero, Go to Step 5.  </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">        <span class="comment">%           Otherwise, cover this row and uncover the column containing </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">        <span class="comment">%           the starred zero. Continue in this manner until there are no </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">        <span class="comment">%           uncovered zeros left. Save the smallest uncovered value and </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">        <span class="comment">%           Go to Step 6.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">        <span class="comment">%**************************************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">        <span class="mxinfo " id="T5:U182"><span class="var type1" id="S41T5U274">cR</span> = <span class="mxinfo " id="T5:U184">find(<span class="mxinfo " id="T7:U185">~<span class="var type1" id="S37T7U278">coverRow</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line">        <span class="mxinfo " id="T1:U187"><span class="var type1" id="S42T1U281">cC</span> = <span class="mxinfo " id="T1:U189">find(<span class="mxinfo " id="T6:U190">~<span class="var type1" id="S35T6U285">coverColumn</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">        <span class="mxinfo " id="T5:U192"><span class="var type1" id="S39T5U288">rIdx</span> = <span class="mxinfo " id="T5:U194"><span class="var type1" id="S41T5U290">cR</span>(<span class="var type1" id="S39T5U291">rIdx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">        <span class="mxinfo " id="T1:U197"><span class="var type1" id="S40T1U294">cIdx</span> = <span class="mxinfo " id="T1:U199"><span class="var type1" id="S42T1U296">cC</span>(<span class="var type1" id="S40T5U297">cIdx</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line">        <span class="mxinfo " id="T2:U202"><span class="var type1" id="S43T2U300">Step</span> = <span class="mxinfo " id="T2:U204">6</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line">        <span class="keyword">while</span> <span class="mxinfo " id="T8:U205">~<span class="mxinfo " id="T8:U206">isempty(<span class="var type1" id="S40T1U306">cIdx</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">            <span class="mxinfo " id="T2:U208"><span class="var type1" id="S45T2U309">uZr</span> = <span class="mxinfo " id="T2:U210"><span class="var type1" id="S39T5U311">rIdx</span>(<span class="mxinfo " id="T2:U212">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">            <span class="mxinfo " id="T2:U213"><span class="var type1" id="S46T2U315">uZc</span> = <span class="mxinfo " id="T2:U215"><span class="var type1" id="S40T1U317">cIdx</span>(<span class="mxinfo " id="T2:U217">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">            <span class="mxinfo " id="T2:U218"><span class="mxinfo " id="T2:U219"><span class="var type1" id="S38T5U322">primeZ</span>(<span class="var type1" id="S45T2U323">uZr</span>)</span> = <span class="var type1" id="S46T2U324">uZc</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">            <span class="mxinfo " id="T2:U223"><span class="var type1" id="S47T2U327">stz</span> = <span class="mxinfo " id="T2:U225"><span class="var type1" id="S29T5U329">starZ</span>(<span class="var type1" id="S45T2U330">uZr</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">            <span class="keyword">if</span> <span class="mxinfo " id="T8:U228">~<span class="var type1" id="S47T2U334">stz</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">                <span class="mxinfo " id="T2:U230"><span class="var type1" id="S43T2U337">Step</span> = <span class="mxinfo " id="T2:U232">5</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">                <span class="keyword">break</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">            <span class="mxinfo " id="T8:U233"><span class="mxinfo " id="T8:U234"><span class="var type1" id="S37T7U343">coverRow</span>(<span class="var type1" id="S45T2U344">uZr</span>)</span> = <span class="mxinfo " id="T8:U237">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">            <span class="mxinfo " id="T8:U238"><span class="mxinfo " id="T8:U239"><span class="var type1" id="S35T6U350">coverColumn</span>(<span class="var type1" id="S47T2U351">stz</span>)</span> = <span class="mxinfo " id="T8:U242">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">            <span class="mxinfo " id="T7:U243"><span class="var type1" id="S48T7U356">z</span> = <span class="mxinfo " id="T7:U245"><span class="var type1" id="S39T5U358">rIdx</span>==<span class="var type1" id="S45T2U359">uZr</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">            <span class="mxinfo " id="T5:U248"><span class="var type1" id="S39T5U363">rIdx</span>(<span class="var type1" id="S48T7U364">z</span>) = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">            <span class="mxinfo " id="T1:U251"><span class="var type1" id="S40T1U370">cIdx</span>(<span class="var type1" id="S48T7U371">z</span>) = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line">            <span class="mxinfo " id="T5:U254"><span class="var type1" id="S41T5U376">cR</span> = <span class="mxinfo " id="T5:U256">find(<span class="mxinfo " id="T7:U257">~<span class="var type1" id="S37T7U380">coverRow</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">            <span class="mxinfo " id="T7:U259"><span class="var type1" id="S48T7U383">z</span> = <span class="mxinfo " id="T7:U261"><span class="mxinfo " id="T5:U262"><span class="var type1" id="S21T3U386">dMat</span>(<span class="mxinfo " id="T7:U264">~<span class="var type1" id="S37T7U388">coverRow</span></span>,<span class="var type1" id="S47T2U389">stz</span>)</span> == <span class="mxinfo " id="T5:U267"><span class="mxinfo " id="T5:U268"><span class="var type1" id="S22T5U392">minR</span>(<span class="mxinfo " id="T7:U270">~<span class="var type1" id="S37T7U394">coverRow</span></span>)</span> + <span class="mxinfo " id="T2:U272"><span class="var type1" id="S24T1U396">minC</span>(<span class="var type1" id="S47T2U397">stz</span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">            <span class="mxinfo " id="T5:U275"><span class="var type1" id="S39T5U400">rIdx</span> = <span class="mxinfo " id="T5:U277">[<span class="mxinfo " id="T5:U278"><span class="var type1" id="S39T5U404">rIdx</span>(:)</span>;<span class="mxinfo " id="T5:U280"><span class="var type1" id="S41T5U408">cR</span>(<span class="var type1" id="S48T7U409">z</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">            <span class="mxinfo " id="T1:U283"><span class="var type1" id="S40T1U412"><span class="message error" id="M1F1C">cIdx</span></span></span> = <span class="mxinfo " id="T5:U284">[<span class="mxinfo " id="T5:U285"><span class="var type1" id="S40T1U416">cIdx</span>(:)</span>;<span class="mxinfo " id="T5:U287"><span class="var type1" id="S47T2U420">stz</span>(<span class="mxinfo " id="T5:U289">ones(<span class="mxinfo " id="T2:U290">sum(<span class="var type1" id="S48T7U425">z</span>)</span>,1)</span>)</span>]</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo " id="T8:U292"><span class="var type1" id="S43T2U430">Step</span> == <span class="mxinfo " id="T2:U294">6</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line">            <span class="comment">% *************************************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">            <span class="comment">% STEP 6: Add the minimum uncovered value to every element of each covered</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line">            <span class="comment">%         row, and subtract it from every element of each uncovered column.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line">            <span class="comment">%         Return to Step 4 without altering any stars, primes, or covered lines.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">            <span class="comment">%**************************************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line">            [<span class="var type1" id="S50T2U435">minval</span>,<span class="var type1" id="S39T5U436">rIdx</span>,<span class="var type1" id="S40T5U437">cIdx</span>]=<span class="fcn" id="F279N4:B439">outerplus</span>(<span class="mxinfo " id="T3:U298"><span class="var type1" id="S21T3U441">dMat</span>(<span class="mxinfo " id="T7:U300">~<span class="var type1" id="S37T7U443">coverRow</span></span>,<span class="mxinfo " id="T6:U302">~<span class="var type1" id="S35T6U445">coverColumn</span></span>)</span>,<span class="mxinfo " id="T5:U304"><span class="var type1" id="S22T5U447">minR</span>(<span class="mxinfo " id="T7:U306">~<span class="var type1" id="S37T7U449">coverRow</span></span>)</span>,<span class="mxinfo " id="T1:U308"><span class="var type1" id="S24T1U451">minC</span>(<span class="mxinfo " id="T6:U310">~<span class="var type1" id="S35T6U453">coverColumn</span></span>)</span>);            </span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line">            <span class="mxinfo " id="T1:U312"><span class="mxinfo " id="T1:U313"><span class="var type1" id="S24T1U457">minC</span>(<span class="mxinfo " id="T6:U315">~<span class="var type1" id="S35T6U459">coverColumn</span></span>)</span> = <span class="mxinfo " id="T1:U317"><span class="mxinfo " id="T1:U318"><span class="var type1" id="S24T1U462">minC</span>(<span class="mxinfo " id="T6:U320">~<span class="var type1" id="S35T6U464">coverColumn</span></span>)</span> + <span class="var type1" id="S50T2U465">minval</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line">            <span class="mxinfo " id="T5:U323"><span class="mxinfo " id="T5:U324"><span class="var type1" id="S22T5U469">minR</span>(<span class="var type1" id="S37T7U470">coverRow</span>)</span> = <span class="mxinfo " id="T5:U327"><span class="mxinfo " id="T5:U328"><span class="var type1" id="S22T5U473">minR</span>(<span class="var type1" id="S37T7U474">coverRow</span>)</span> - <span class="var type1" id="S50T2U475">minval</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line">            <span class="keyword">break</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line">    <span class="comment">%**************************************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line">    <span class="comment">% STEP 5:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line">    <span class="comment">%  Construct a series of alternating primed and starred zeros as</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line">    <span class="comment">%  follows:</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line">    <span class="comment">%  Let Z0 represent the uncovered primed zero found in Step 4.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line">    <span class="comment">%  Let Z1 denote the starred zero in the column of Z0 (if any).</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line">    <span class="comment">%  Let Z2 denote the primed zero in the row of Z1 (there will always</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line">    <span class="comment">%  be one).  Continue until the series terminates at a primed zero</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line">    <span class="comment">%  that has no starred zero in its column.  Unstar each starred</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line">    <span class="comment">%  zero of the series, star each primed zero of the series, erase</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line">    <span class="comment">%  all primes and uncover every line in the matrix.  Return to Step 3.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line">    <span class="comment">%**************************************************************************</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line">    <span class="mxinfo " id="T5:U332"><span class="var type1" id="S52T5U480">rowZ1</span> = <span class="mxinfo " id="T5:U334">find(<span class="mxinfo " id="T7:U335"><span class="var type1" id="S29T5U484">starZ</span>==<span class="var type1" id="S46T2U485">uZc</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line">    <span class="mxinfo " id="T2:U338"><span class="mxinfo " id="T2:U339"><span class="var type1" id="S29T5U489">starZ</span>(<span class="var type1" id="S45T2U490">uZr</span>)</span>=<span class="var type1" id="S46T2U491">uZc</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line">    <span class="keyword">while</span> <span class="mxinfo " id="T7:U343"><span class="var type1" id="S52T5U494">rowZ1</span>&gt;<span class="mxinfo " id="T2:U345">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line">        <span class="mxinfo " id="T5:U346"><span class="mxinfo " id="T5:U347"><span class="var type1" id="S29T5U499">starZ</span>(<span class="var type1" id="S52T5U500">rowZ1</span>)</span>=<span class="mxinfo " id="T2:U350">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line">        <span class="mxinfo " id="T2:U351"><span class="var type1" id="S46T2U504"><span class="message error" id="M2F1C">uZc</span></span></span> = <span class="mxinfo " id="T5:U352"><span class="var type1" id="S38T5U506">primeZ</span>(<span class="var type1" id="S52T5U507">rowZ1</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line">        <span class="mxinfo " id="T2:U355"><span class="var type1" id="S45T2U510"><span class="message error" id="M3F1C">uZr</span></span></span> = <span class="var type1" id="S52T5U511">rowZ1</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line">        <span class="mxinfo " id="T5:U357"><span class="var type1" id="S52T5U514">rowZ1</span> = <span class="mxinfo " id="T5:U359">find(<span class="mxinfo " id="T7:U360"><span class="var type1" id="S29T5U518">starZ</span>==<span class="var type1" id="S46T2U519">uZc</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line">        <span class="mxinfo " id="T2:U363"><span class="mxinfo " id="T2:U364"><span class="var type1" id="S29T5U523">starZ</span>(<span class="var type1" id="S45T2U524">uZr</span>)</span>=<span class="var type1" id="S46T2U525">uZc</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line"><span class="comment">% Cost of assignment</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line"><span class="mxinfo " id="T5:U368"><span class="var type1" id="S53T5U528">rowIdx</span> = <span class="mxinfo " id="T5:U370">find(<span class="var type1" id="S15T7U531">validRow</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line"><span class="mxinfo " id="T1:U372"><span class="var type1" id="S54T1U534">colIdx</span> = <span class="mxinfo " id="T1:U374">find(<span class="var type1" id="S13T6U537">validCol</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line"><span class="mxinfo " id="T5:U376"><span class="var type1" id="S29T5U540">starZ</span> = <span class="mxinfo " id="T5:U378"><span class="var type1" id="S29T5U542">starZ</span>(<span class="mxinfo " id="T1:U380"><span class="mxinfo " id="T2:U381">1</span>:<span class="var type1" id="S16T2U545">nRows</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line"><span class="mxinfo " id="T7:U383"><span class="var type1" id="S55T7U548">vIdx</span> = <span class="mxinfo " id="T7:U385"><span class="var type1" id="S29T5U550">starZ</span> &lt;= <span class="var type1" id="S17T2U551">nCols</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line"><span class="mxinfo " id="T5:U388"><span class="mxinfo " id="T5:U389"><span class="var type1" id="S2T1U555">assignment</span>(<span class="mxinfo " id="T5:U391"><span class="var type1" id="S53T5U557">rowIdx</span>(<span class="var type1" id="S55T7U558">vIdx</span>)</span>)</span> = <span class="mxinfo " id="T5:U394"><span class="var type1" id="S54T1U560">colIdx</span>(<span class="mxinfo " id="T5:U396"><span class="var type1" id="S29T5U562">starZ</span>(<span class="var type1" id="S55T7U563">vIdx</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line"><span class="mxinfo " id="T1:U399"><span class="var type1" id="S56T1U566">pass</span> = <span class="mxinfo " id="T1:U401"><span class="var type1" id="S2T1U568">assignment</span>(<span class="mxinfo " id="T6:U403"><span class="var type1" id="S2T1U570">assignment</span>&gt;<span class="mxinfo " id="T2:U405">0</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line"><span class="mxinfo " id="T5:U406"><span class="mxinfo " id="T5:U407"><span class="var type1" id="S56T1U575">pass</span>(<span class="mxinfo " id="T7:U409">~<span class="mxinfo " id="T7:U410">diag(<span class="mxinfo " id="T4:U411"><span class="var type1" id="S7T4U580">validMat</span>(<span class="mxinfo " id="T6:U413"><span class="var type1" id="S2T1U582">assignment</span>&gt;<span class="mxinfo " id="T2:U415">0</span></span>,<span class="var type1" id="S56T1U584">pass</span>)</span>)</span></span>)</span> = <span class="mxinfo " id="T2:U417">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line"><span class="mxinfo " id="T1:U418"><span class="mxinfo " id="T1:U419"><span class="var type1" id="S2T1U589">assignment</span>(<span class="mxinfo " id="T6:U421"><span class="var type1" id="S2T1U591">assignment</span>&gt;<span class="mxinfo " id="T2:U423">0</span></span>)</span> = <span class="var type1" id="S56T1U593">pass</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line"><span class="mxinfo " id="T2:U425"><span class="var type1" id="S3T2U596">cost</span> = <span class="mxinfo " id="T2:U427">trace(<span class="mxinfo " id="T3:U428"><span class="var type1" id="S4T3U600">costMat</span>(<span class="mxinfo " id="T6:U430"><span class="var type1" id="S2T1U602">assignment</span>&gt;<span class="mxinfo " id="T2:U432">0</span></span>,<span class="mxinfo " id="T1:U433"><span class="var type1" id="S2T1U605">assignment</span>(<span class="mxinfo " id="T6:U435"><span class="var type1" id="S2T1U607">assignment</span>&gt;<span class="mxinfo " id="T2:U437">0</span></span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line"></span></span>
</pre>
<div class="dead">
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line">function [minval,rIdx,cIdx]=outerplus(M,x,y)</span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line">ny=size(M,2);</span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line">minval=inf;</span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line">for c=1:ny</span></span>
<span class="srcline"><span class="lineno"><a href="1,197" id="srcline197">197</a></span><span class="line">    M(:,c)=M(:,c)-(x+y(c));</span></span>
<span class="srcline"><span class="lineno"><a href="1,198" id="srcline198">198</a></span><span class="line">    minval = min(minval,min(M(:,c)));</span></span>
<span class="srcline"><span class="lineno"><a href="1,199" id="srcline199">199</a></span><span class="line">end</span></span>
<span class="srcline"><span class="lineno"><a href="1,200" id="srcline200">200</a></span><span class="line">[rIdx,cIdx]=find(M==minval);</span></span>
<span class="srcline"><span class="lineno"><a href="1,201" id="srcline201">201</a></span><span class="line"> </span></span>
</pre>
</div>
</body>
</html>
